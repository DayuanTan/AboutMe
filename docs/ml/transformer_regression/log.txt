$ python transformer_regression.py

Begin People predict income using Transformer

Creating People Dataset objects
tmp x:  [[ 1.    0.24  1.   ...  0.    0.    1.  ]
 [-1.    0.39  0.   ...  0.    1.    0.  ]
 [ 1.    0.63  0.   ...  1.    0.    0.  ]
 ...
 [ 1.    0.44  1.   ...  0.    1.    0.  ]
 [ 1.    0.28  1.   ...  0.    0.    1.  ]
 [ 1.    0.54  0.   ...  1.    0.    0.  ]]
tmp y:  [[0.295]
 [0.512]
 [0.758]
 [0.445]
 [0.286]
 [0.565]
 [0.55 ]
 [0.327]
 [0.277]
 [0.471]
 [0.394]
 [0.335]
 [0.352]
 [0.464]
 [0.541]
 [0.507]
 [0.468]
 [0.3  ]
 [0.464]
 [0.325]
 [0.54 ]
 [0.713]
 [0.724]
 [0.61 ]
 [0.363]
 [0.55 ]
 [0.625]
 [0.524]
 [0.236]
 [0.784]
 [0.717]
 [0.465]
 [0.371]
 [0.489]
 [0.48 ]
 [0.654]
 [0.607]
 [0.511]
 [0.532]
 [0.372]
 [0.646]
 [0.748]
 [0.588]
 [0.727]
 [0.666]
 [0.36 ]
 [0.701]
 [0.643]
 [0.403]
 [0.51 ]
 [0.535]
 [0.581]
 [0.679]
 [0.657]
 [0.526]
 [0.668]
 [0.627]
 [0.277]
 [0.629]
 [0.418]
 [0.356]
 [0.52 ]
 [0.517]
 [0.697]
 [0.664]
 [0.758]
 [0.343]
 [0.601]
 [0.548]
 [0.523]
 [0.301]
 [0.535]
 [0.586]
 [0.425]
 [0.393]
 [0.404]
 [0.707]
 [0.48 ]
 [0.644]
 [0.717]
 [0.489]
 [0.564]
 [0.663]
 [0.648]
 [0.52 ]
 [0.804]
 [0.504]
 [0.484]
 [0.72 ]
 [0.587]
 [0.528]
 [0.409]
 [0.484]
 [0.6  ]
 [0.606]
 [0.41 ]
 [0.39 ]
 [0.337]
 [0.407]
 [0.47 ]
 [0.403]
 [0.503]
 [0.28 ]
 [0.58 ]
 [0.635]
 [0.478]
 [0.398]
 [0.716]
 [0.5  ]
 [0.558]
 [0.39 ]
 [0.783]
 [0.42 ]
 [0.427]
 [0.57 ]
 [0.75 ]
 [0.7  ]
 [0.689]
 [0.24 ]
 [0.43 ]
 [0.364]
 [0.48 ]
 [0.713]
 [0.348]
 [0.371]
 [0.567]
 [0.567]
 [0.294]
 [0.552]
 [0.263]
 [0.53 ]
 [0.725]
 [0.3  ]
 [0.493]
 [0.75 ]
 [0.343]
 [0.327]
 [0.318]
 [0.486]
 [0.41 ]
 [0.557]
 [0.384]
 [0.566]
 [0.588]
 [0.698]
 [0.594]
 [0.435]
 [0.62 ]
 [0.564]
 [0.559]
 [0.345]
 [0.667]
 [0.428]
 [0.772]
 [0.335]
 [0.432]
 [0.75 ]
 [0.711]
 [0.413]
 [0.706]
 [0.4  ]
 [0.627]
 [0.377]
 [0.575]
 [0.274]
 [0.203]
 [0.382]
 [0.348]
 [0.33 ]
 [0.63 ]
 [0.818]
 [0.637]
 [0.584]
 [0.486]
 [0.589]
 [0.726]
 [0.36 ]
 [0.625]
 [0.215]
 [0.43 ]
 [0.423]
 [0.674]
 [0.465]
 [0.652]
 [0.675]
 [0.66 ]
 [0.563]
 [0.298]
 [0.593]
 [0.644]
 [0.286]
 [0.662]
 [0.551]
 [0.629]
 [0.462]
 [0.727]
 [0.407]
 [0.523]
 [0.313]
 [0.626]]
tmp x:  [[-1.    0.51  1.    0.    0.    0.    1.    0.  ]
 [-1.    0.32  0.    1.    0.    0.    1.    0.  ]
 [ 1.    0.55  1.    0.    0.    1.    0.    0.  ]
 [ 1.    0.25  0.    0.    1.    0.    0.    1.  ]
 [ 1.    0.33  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.29  0.    1.    0.    1.    0.    0.  ]
 [ 1.    0.65  1.    0.    0.    1.    0.    0.  ]
 [-1.    0.43  0.    1.    0.    0.    1.    0.  ]
 [-1.    0.54  0.    1.    0.    0.    0.    1.  ]
 [ 1.    0.61  0.    1.    0.    1.    0.    0.  ]
 [ 1.    0.52  0.    1.    0.    1.    0.    0.  ]
 [ 1.    0.3   0.    1.    0.    0.    0.    1.  ]
 [ 1.    0.29  1.    0.    0.    0.    0.    1.  ]
 [-1.    0.47  0.    0.    1.    0.    1.    0.  ]
 [ 1.    0.39  0.    1.    0.    0.    1.    0.  ]
 [ 1.    0.47  0.    0.    1.    0.    1.    0.  ]
 [-1.    0.49  1.    0.    0.    0.    1.    0.  ]
 [-1.    0.63  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.3   1.    0.    0.    1.    0.    0.  ]
 [-1.    0.61  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.47  0.    0.    1.    0.    1.    0.  ]
 [ 1.    0.3   0.    0.    1.    0.    0.    1.  ]
 [-1.    0.51  0.    0.    1.    0.    1.    0.  ]
 [-1.    0.24  1.    0.    0.    0.    1.    0.  ]
 [-1.    0.49  1.    0.    0.    0.    1.    0.  ]
 [ 1.    0.66  0.    0.    1.    1.    0.    0.  ]
 [-1.    0.65  1.    0.    0.    1.    0.    0.  ]
 [-1.    0.46  0.    1.    0.    1.    0.    0.  ]
 [-1.    0.45  0.    0.    1.    0.    1.    0.  ]
 [-1.    0.47  1.    0.    0.    1.    0.    0.  ]
 [-1.    0.29  1.    0.    0.    1.    0.    0.  ]
 [-1.    0.57  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.2   1.    0.    0.    0.    0.    1.  ]
 [-1.    0.35  1.    0.    0.    0.    1.    0.  ]
 [-1.    0.61  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.31  0.    0.    1.    0.    1.    0.  ]
 [ 1.    0.18  1.    0.    0.    0.    0.    1.  ]
 [ 1.    0.26  0.    0.    1.    0.    0.    1.  ]
 [-1.    0.28  1.    0.    0.    0.    0.    1.  ]
 [-1.    0.59  0.    0.    1.    0.    0.    1.  ]]
tmp y:  [[0.612]
 [0.461]
 [0.627]
 [0.262]
 [0.373]
 [0.462]
 [0.727]
 [0.514]
 [0.648]
 [0.727]
 [0.636]
 [0.335]
 [0.314]
 [0.594]
 [0.478]
 [0.52 ]
 [0.586]
 [0.674]
 [0.392]
 [0.696]
 [0.587]
 [0.345]
 [0.58 ]
 [0.388]
 [0.645]
 [0.745]
 [0.769]
 [0.58 ]
 [0.518]
 [0.636]
 [0.448]
 [0.693]
 [0.287]
 [0.434]
 [0.67 ]
 [0.373]
 [0.208]
 [0.292]
 [0.364]
 [0.694]]

Creating (8--32)-T-10-1 neural network

bat_size = 10
loss = MSELoss()
optimizer = Adam
lrn_rate = 0.01

Starting training
epoch =    0  |  loss = 4.4920
epoch =   50  |  loss = 0.4227
epoch =  100  |  loss = 0.3716
epoch =  150  |  loss = 0.1129
epoch =  200  |  loss = 0.0821
epoch =  250  |  loss = 0.0941
Done

Computing model accuracy (within 0.10 of true)
Accuracy on train data = 0.6500
Accuracy on test data = 0.6250

Predicting income for M 34 Oklahoma moderate:
$47322.27

Saving trained model state

End People income demo