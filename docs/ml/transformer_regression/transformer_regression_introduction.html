<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>
Regression Using a PyTorch Neural Network with a Transformer Component | James D. McCaffrey</title>
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="https://s0.wp.com/wp-content/themes/pub/twentyten/style.css?ver=20190507" />
<link rel="pingback" href="https://jamesmccaffrey.wordpress.com/xmlrpc.php">
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel="alternate" type="application/rss+xml" title="James D. McCaffrey &raquo; Feed" href="https://jamesmccaffrey.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="James D. McCaffrey &raquo; Comments Feed" href="https://jamesmccaffrey.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="James D. McCaffrey &raquo; Regression Using a PyTorch Neural Network with a Transformer&nbsp;Component Comments Feed" href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1710334132i&ver=6.5-RC3-57891"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1s9KLSlITM6G8vVz8/NBREppTmqxflFqTmJJaopuQX5xCRpPL7m4WEcfu5E5mdmpCIPBPJBy+1xbQ3MDUxNjcwNzyywAYHY02w==&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJylzFsOQDAQQNENaadDPH7EWrQmVUZJH8TuiS34vLnJgesQZveJfIKDs3U+gs1vagr2PYHgxE4qqUBnxxNo3s0q2OkwhhtiupmkibGAf1CaafugYeuxRaybuqxweQAjPzhI&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.wp-block-cover__image-background.has-parallax {
	background-size: cover;
}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s0.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-6-1' href='https://s0.wp.com/_static/??-eJyVzDEOgCAMQNELiQU1Jg7Gs2AlDYpAaInx9ro5O/7hfbiywhTFRYEcKvnIQPXN1RVSa0h4MOxOssVDBXunKoqK34DlDq5F5gb+LIoVH4k/vpyzGYe+03oyw/4AcmU1KQ==&cssminify=yes' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s0.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--blue: #0066cc;--wp--preset--color--medium-gray: #666;--wp--preset--color--light-gray: #f1f1f1;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1709200696i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1705430309' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s0.wp.com/_static/??-eJyFjsEOwjAMQ3+IECaxiR0Q37JVoRTaplpSVfv7hRsTEtxsy88ytgKOs1JW1AclEix1Rm0WrJbiHNm95OhEDvivK7pGglYcpy8gVSix+pAFPTHY6qSB887APU5h+YUuZH+8SY/W+rBv6Jau3dCdzv3YX8bnBpo6UWU=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s0.wp.com/_static/??-eJyNjcEKwjAQRH/IuA1aehI/ReImJKmb3eAmFP9eW3oRL16GeTC8gaUaFG6BG5RuKvWYWWEOrTp87AxFZA3fKShocs/gnfevrWaOR1Q9wP+mW2YEFcyODEkU/YIfW0uhfH7TGSLJ3dE6uJaLneww2mkYT/MbUOlJHA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="media-video-jwt-bridge-js-extra">
/* <![CDATA[ */
var videopressAjax = {"ajaxUrl":"https:\/\/jamesmccaffrey.wordpress.com\/wp-admin\/admin-ajax.php","bridgeUrl":"\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/jetpack_vendor\/automattic\/jetpack-videopress\/build\/lib\/token-bridge.js","post_id":"29662"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"16384225","postID":"29662","siteURL":"http:\/\/jamesmccaffrey.wordpress.com","xhrURL":"https:\/\/jamesmccaffrey.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"3fa6976452","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p16KhH-7Iq","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJyVjj0OwjAMhS9EcDqgigFxlCptTOU2saPEKXB7MlQI2Bi/p/cH92QmYUVWWApEGSmgqQWzm5tmiG9yXMoBPnyxmhTqTFxgQU1uWnducWEYiCcYKwUPGYNT9CZJ0fJNx0j8W9wO5KAmZXk8/xzdtWFD9pLBVZXoVGl6uzfyKCljKfu5QCOorMhmzORnbIvXeOl6a23fnc52eQHwqWpF'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://jamesmccaffrey.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" />
<link rel='shortlink' href='https://wp.me/p16KhH-7Iq' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Regression Using a PyTorch Neural Network with a Transformer Component" />
<meta property="og:url" content="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" />
<meta property="og:description" content="Transformers are software modules that are the basis of large language models (GPT-4, Orca-2, LLaMA-2, etc.) A regression problem is one that predicts a single numeric value. Neural network regress…" />
<meta property="article:published_time" content="2023-12-01T11:30:09+00:00" />
<meta property="article:modified_time" content="2023-12-01T12:18:24+00:00" />
<meta property="og:site_name" content="James D. McCaffrey" />
<meta property="og:image" content="https://jamesmccaffrey.files.wordpress.com/2023/11/pytorch_regression_people_income_transformer.jpg?w=640" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="407" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:text:title" content="Regression Using a PyTorch Neural Network with a Transformer&nbsp;Component" />
<meta name="twitter:image" content="https://jamesmccaffrey.files.wordpress.com/2023/11/pytorch_regression_people_income_transformer.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=32" sizes="16x16" />
<link rel="apple-touch-icon" href="https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=114" />
<link rel='openid.server' href='https://jamesmccaffrey.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://jamesmccaffrey.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://jamesmccaffrey.wordpress.com/osd.xml" title="James D. McCaffrey" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="application-name" content="James D. McCaffrey" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Software Research, Development, Testing, and Education" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://jamesmccaffrey.wordpress.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s0.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico" /><meta name="description" content="Transformers are software modules that are the basis of large language models (GPT-4, Orca-2, LLaMA-2, etc.) A regression problem is one that predicts a single numeric value. Neural network regression systems are well-studied, but what happens if a Transformer is inserted into a regression system? I put together a demo using one of my standard&hellip;" />
			<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&#038;csblog=16KhH&#038;cscache=6&#038;csrev=10" />
			<!-- Your Google Analytics Plugin is missing the tracking ID -->
</head>

<body class="post-template-default single single-post postid-29662 single-format-standard customizer-styles-applied single-author jetpack-reblog-enabled">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="https://jamesmccaffrey.wordpress.com/" title="James D. McCaffrey" rel="home">James D. McCaffrey</a>
					</span>
				</div>
				<div id="site-description">Software Research, Development, Testing, and Education</div>

									<a class="home-link" href="https://jamesmccaffrey.wordpress.com/" title="James D. McCaffrey" rel="home">
						<img src="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2020/06/mccaffrey_header_img_940_198.jpg" width="940" height="198" alt="" />
					</a>
								</div><!-- #branding -->

			<div id="access" role="navigation">
								<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
				<div class="menu"><ul>
<li ><a href="https://jamesmccaffrey.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://jamesmccaffrey.wordpress.com/about/">About Me</a></li>
<li class="page_item page-item-15130 page_item_has_children"><a href="https://jamesmccaffrey.wordpress.com/publications/">Publications</a>
<ul class='children'>
	<li class="page_item page-item-15616"><a href="https://jamesmccaffrey.wordpress.com/publications/recent/">Recent</a></li>
	<li class="page_item page-item-15132"><a href="https://jamesmccaffrey.wordpress.com/publications/technical-journals/">Technical Journals</a></li>
	<li class="page_item page-item-15134"><a href="https://jamesmccaffrey.wordpress.com/publications/books-and-e-books/">Books and e-Books</a></li>
	<li class="page_item page-item-15136"><a href="https://jamesmccaffrey.wordpress.com/publications/research-papers/">Research Papers</a></li>
	<li class="page_item page-item-15141 page_item_has_children"><a href="https://jamesmccaffrey.wordpress.com/publications/old-publications/">Old Publications</a>
	<ul class='children'>
		<li class="page_item page-item-15165"><a href="https://jamesmccaffrey.wordpress.com/publications/old-publications/archive/">Archive</a></li>
	</ul>
</li>
</ul>
</li>
</ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="https://jamesmccaffrey.wordpress.com/2023/11/30/an-example-of-an-ensemble-system-with-a-neural-network-and-a-k-nearest-neighbors-model-from-scratch-using-csharp/" rel="prev"><span class="meta-nav">&larr;</span> An Example of an Ensemble System With a Neural Network and a k-Nearest Neighbors Model From Scratch Using&nbsp;C#</a></div>
					<div class="nav-next"><a href="https://jamesmccaffrey.wordpress.com/2023/12/04/a-quick-look-at-the-lm-studio-tool-for-exploring-large-language-models/" rel="next">A Quick Look At The LM Studio Tool For Exploring Large Language&nbsp;Models <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-29662" class="post-29662 post type-post status-publish format-standard hentry category-pytorch">
											<h2 class="entry-title"><a href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" rel="bookmark">Regression Using a PyTorch Neural Network with a Transformer&nbsp;Component</a></h2>					
					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" title="3:30 am" rel="bookmark"><span class="entry-date">December 1, 2023</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="https://jamesmccaffrey.wordpress.com/author/jamesdmccaffrey/" title="View all posts by jamesdmccaffrey">jamesdmccaffrey</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>Transformers are software modules that are the basis of large language models (GPT-4, Orca-2, LLaMA-2, etc.) A regression problem is one that predicts a single numeric value. Neural network regression systems are well-studied, but what happens if a Transformer is inserted into a regression system?</p>
<p><a href="https://jamesmccaffrey.wordpress.com/2023/11/30/regression-using-a-pytorch-neural-network-with-a-transformer-component/pytorch_regression_people_income_transformer/" rel="attachment wp-att-29664"><img data-attachment-id="29664" data-permalink="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/pytorch_regression_people_income_transformer/" data-orig-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg" data-orig-size="2200,1400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="pytorch_regression_people_income_transformer" data-image-description="" data-image-caption="" data-medium-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=300" data-large-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=640" src="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=640&#038;h=407" alt="" width="640" height="407" class="alignnone size-large wp-image-29664" srcset="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=640 640w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=1280 1280w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=150 150w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=300 300w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=768 768w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_people_income_transformer.jpg?w=1024 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>I put together a demo using one of my standard synthetic datasets. The goal is to predict a person&#8217;s income (divided by $100,000) from sex (male = -1, female = +1), age (divided by 100), State (Michigan = 100, Nebraska = 010, Oklahoma = 001), and political leaning (conservative = 100, moderate &#8211; 010, liberal = 001). The tab-delimited data looks like:</p>
<pre>
 1  0.24  1  0  0  0.2950  0  0  1
-1  0.39  0  0  1  0.5120  0  1  0
 1  0.63  0  1  0  0.7580  1  0  0
-1  0.36  1  0  0  0.4450  0  1  0
 1  0.27  0  1  0  0.2860  0  0  1
. . .
</pre>
<p>There are 200 training items and 40 test items. The technique works but it’s not clear if adding a Transformer to a regression system improves the system enough to warrant the added complexity.</p>
<p>For natural language problems, a Transformer component expects data in a very specific format. Each input sentence is broken into integer tokens, each token is projected to an embedding vector, and each embedding vector is augmented with positional encoding. Therefore, my biggest challenge was to create a custom PyTorch layer module that transforms my input into a form that can be consumed by the Transformer component. I did so by implementing a custom SkipLinear module (I&#8217;m not sure why I used such a weird name).</p>
<p><a href="https://jamesmccaffrey.wordpress.com/2023/11/30/regression-using-a-pytorch-neural-network-with-a-transformer-component/pytorch_regression_transformer_diagram/" rel="attachment wp-att-29666"><img data-attachment-id="29666" data-permalink="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/pytorch_regression_transformer_diagram/" data-orig-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg" data-orig-size="1856,1177" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="pytorch_regression_transformer_diagram" data-image-description="" data-image-caption="" data-medium-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=300" data-large-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=640" src="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=640&#038;h=406" alt="" width="640" height="406" class="alignnone size-large wp-image-29666" srcset="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=640 640w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=1280 1280w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=150 150w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=300 300w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=768 768w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/11/pytorch_regression_transformer_diagram.jpg?w=1024 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>From a practical point of view, the major downside to adding a Transformer to a regression system is dealing with the five additional hyperparameters: pseudo-embedding size, positional dropout rate, number heads, internal feedforward size , number Transformer layer. I suspect that a regression system that incorporates a Transformer is most likely useful for very difficult problems with a very large dataset and a large number of predictor variables.</p>
<hr>
<p><a href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/unusual_dice_2/" rel="attachment wp-att-29675"><img data-attachment-id="29675" data-permalink="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/unusual_dice_2/" data-orig-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg" data-orig-size="3410,886" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="unusual_dice_2" data-image-description="" data-image-caption="" data-medium-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=300" data-large-file="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=640" src="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=640&#038;h=166" alt="" width="640" height="166" class="alignnone size-large wp-image-29675" srcset="https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=640 640w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=1278 1278w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=150 150w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=300 300w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=768 768w, https://jamesmccaffrey.wordpress.com/wp-content/uploads/2023/12/unusual_dice_2.jpg?w=1024 1024w" sizes="(max-width: 640px) 100vw, 640px" /></a><br />
<i>Neural systems have an element of randomness due to the random initialization of weights and biases. Here are three interesting sets of dice. Left: A pair of 7-sided dice. This design has generated a lot of commentary. I&#8217;m highly skeptical the dice are completely fair but they&#8217;re probably good enough for board games where money isn&#8217;t involved. Center: Skewed dice. Each side has the same shape so the dice are fair, subject to manufacturing tolerances. Right: Designer AKO (&#8220;another kind of dice&#8221;) dice. Experiments show the dice are close to, but not completely, fair.</i></p>
<hr>
<p>Demo code. Replace &#8220;lt&#8221; with Boolean less-than operator symbol. (My lame blog editor often chokes on symbols).</p>
<pre>
# people_income_transformer.py
# predict income from sex, age, city, politics
# PyTorch 2.0.0-CPU Anaconda3-2022.10  Python 3.9.13
# Windows 10/11 

# Transformer component for regression

import numpy as np
import torch as T

device = T.device('cpu')  # apply to Tensor or Module

# -----------------------------------------------------------

class PeopleDataset(T.utils.data.Dataset):
  def __init__(self, src_file):
    # sex age   state   income   politics
    # -1  0.27  0 1 0   0.7610   0 0 1
    # +1  0.19  0 0 1   0.6550   1 0 0

    tmp_x = np.loadtxt(src_file, usecols=[0,1,2,3,4,6,7,8],
      delimiter="\t", comments="#", dtype=np.float32)
    tmp_y = np.loadtxt(src_file, usecols=5, delimiter="\t",
      comments="#", dtype=np.float32)
    tmp_y = tmp_y.reshape(-1,1)  # 2D required

    self.x_data = T.tensor(tmp_x, dtype=T.float32).to(device)
    self.y_data = T.tensor(tmp_y, dtype=T.float32).to(device)

  def __len__(self):
    return len(self.x_data)

  def __getitem__(self, idx):
    preds = self.x_data[idx]
    incom = self.y_data[idx] 
    return (preds, incom)  # as a tuple

# -----------------------------------------------------------

class SkipLinear(T.nn.Module):

  # -----

  class Core(T.nn.Module):
    def __init__(self, n):
      super().__init__()
      # 1 node to n nodes, n gte 2
      self.weights = T.nn.Parameter(T.zeros((n,1),
        dtype=T.float32))
      self.biases = T.nn.Parameter(T.tensor(n,
        dtype=T.float32))
      lim = 0.01
      T.nn.init.uniform_(self.weights, -lim, lim)
      T.nn.init.zeros_(self.biases)

    def forward(self, x):
      wx= T.mm(x, self.weights.t())
      v = T.add(wx, self.biases)
      return v

  # -----

  def __init__(self, n_in, n_out):
    super().__init__()
    self.n_in = n_in; self.n_out = n_out
    if n_out  % n_in != 0:
      print("FATAL: n_out must be divisible by n_in")
    n = n_out // n_in  # num nodes per input

    self.lst_modules = \
      T.nn.ModuleList([SkipLinear.Core(n) for \
        i in range(n_in)])

  def forward(self, x):
    lst_nodes = []
    for i in range(self.n_in):
      xi = x[:,i].reshape(-1,1)
      oupt = self.lst_modules[i](xi)
      lst_nodes.append(oupt)
    result = T.cat((lst_nodes[0], lst_nodes[1]), 1)
    for i in range(2,self.n_in):
      result = T.cat((result, lst_nodes[i]), 1)
    result = result.reshape(-1, self.n_out)
    return result

# -----------------------------------------------------------

class PositionalEncoding(T.nn.Module):  # documentation code
  def __init__(self, d_model: int, dropout: float=0.1,
   max_len: int=5000):
    super(PositionalEncoding, self).__init__()  # old syntax
    self.dropout = T.nn.Dropout(p=dropout)
    pe = T.zeros(max_len, d_model)  # like 10x4
    position = \
      T.arange(0, max_len, dtype=T.float).unsqueeze(1)
    div_term = T.exp(T.arange(0, d_model, 2).float() * \
      (-np.log(10_000.0) / d_model))
    pe[:, 0::2] = T.sin(position * div_term)
    pe[:, 1::2] = T.cos(position * div_term)
    pe = pe.unsqueeze(0).transpose(0, 1)
    self.register_buffer('pe', pe)  # allows state-save

  def forward(self, x):
    x = x + self.pe[:x.size(0), :]
    return self.dropout(x)

# -----------------------------------------------------------

class TransformerNet(T.nn.Module):
  def __init__(self):
    super(TransformerNet, self).__init__()
    self.embed = SkipLinear(8, 32)  # 8 inputs, each goes to 4 
    self.pos_enc = \
      PositionalEncoding(4, dropout=0.20)  # positional
    self.enc_layer = T.nn.TransformerEncoderLayer(d_model=4,
      nhead=2, dim_feedforward=10, 
      batch_first=True)  # d_model divisible by nhead
    self.trans_enc = T.nn.TransformerEncoder(self.enc_layer,
      num_layers=2)  # 6 layers default

    self.fc1 = T.nn.Linear(32, 10)  # 8--32-T-10-1
    self.fc2 = T.nn.Linear(10, 1)

    # default weight and bias initialization

  def forward(self, x):
    z = self.embed(x)  # 8 inpts to 32 embed
    z = z.reshape(-1, 8, 4)  # bat seq embed
    z = self.pos_enc(z) 
    z = self.trans_enc(z) 
    z = z.reshape(-1, 32)  # torch.Size([bs, xxx])
    z = T.tanh(self.fc1(z))
    z = self.fc2(z)  # regression: no activation
    return z

# -----------------------------------------------------------

def accuracy(model, ds, pct_close):
  # assumes model.eval()
  # correct within pct of true income
  n_correct = 0; n_wrong = 0

  for i in range(len(ds)):
    X = ds[i][0].reshape(1,-1)  # make it a batch
    Y = ds[i][1].reshape(1)
    with T.no_grad():
      oupt = model(X)         # computed income

    if T.abs(oupt - Y) "lt" T.abs(pct_close * Y):
      n_correct += 1
    else:
      n_wrong += 1
  acc = (n_correct * 1.0) / (n_correct + n_wrong)
  return acc

# -----------------------------------------------------------

def accuracy_x(model, ds, pct_close):
  # all-at-once (quick)
  # assumes model.eval()
  X = ds.x_data  # all inputs
  Y = ds.y_data  # all targets
  n_items = len(X)
  with T.no_grad():
    pred = model(X)  # all predicted incomes
 
  n_correct = T.sum((T.abs(pred - Y) "lt" \
    T.abs(pct_close * Y)))
  result = (n_correct.item() / n_items)  # scalar
  return result  

# -----------------------------------------------------------

def train(model, ds, bs, lr, me, le, test_ds):
  # dataset, bat_size, lrn_rate, max_epochs, log interval
  train_ldr = T.utils.data.DataLoader(ds, batch_size=bs,
    shuffle=True)
  loss_func = T.nn.MSELoss()
  optimizer = T.optim.Adam(model.parameters(), lr=lr)

  for epoch in range(0, me):
    epoch_loss = 0.0  # for one full epoch
    for (b_idx, batch) in enumerate(train_ldr):
      X = batch[0]  # predictors
      y = batch[1]  # target income
      optimizer.zero_grad()
      oupt = model(X)
      loss_val = loss_func(oupt, y)  # a tensor
      epoch_loss += loss_val.item()  # accumulate
      loss_val.backward()  # compute gradients
      optimizer.step()     # update weights

    if epoch % le == 0:
      print("epoch = %4d  |  loss = %0.4f" % \
        (epoch, epoch_loss))
      # model.eval()
      # print("-------------")
      # acc_train = accuracy(model, ds, 0.10)
      # print("Accuracy on train data = %0.4f" % acc_train)
      # acc_test = accuracy(model, test_ds, 0.10) 
      # print("Accuracy on test data = %0.4f" % acc_test)
      # model.train()
      # print("-------------")

# -----------------------------------------------------------

def main():
  # 0. get started
  print("\nBegin People predict income using Transformer ")
  T.manual_seed(0)
  np.random.seed(0)
  
  # 1. create Dataset objects
  print("\nCreating People Dataset objects ")
  train_file = ".\\Data\\people_train.txt"
  train_ds = PeopleDataset(train_file)  # 200 rows

  test_file = ".\\Data\\people_test.txt"
  test_ds = PeopleDataset(test_file)  # 40 rows

  # 2. create network
  print("\nCreating (8--32)-T-10-1 neural network ")
  net = TransformerNet().to(device)

# -----------------------------------------------------------

  # 3. train model
  print("\nbat_size = 10 ")
  print("loss = MSELoss() ")
  print("optimizer = Adam ")
  print("lrn_rate = 0.01 ")

  print("\nStarting training")
  net.train()
  train(net, train_ds, bs=10, lr=0.01, me=300,
    le=50, test_ds=test_ds)
  print("Done ")

# -----------------------------------------------------------

  # 4. evaluate model accuracy
  print("\nComputing model accuracy (within 0.10 of true) ")
  net.eval()
  acc_train = accuracy(net, train_ds, 0.10)  # item-by-item
  print("Accuracy on train data = %0.4f" % acc_train)

  acc_test = accuracy_x(net, test_ds, 0.10)  # all-at-once
  print("Accuracy on test data = %0.4f" % acc_test)

# -----------------------------------------------------------

  # 5. make a prediction
  print("\nPredicting income for M 34 Oklahoma moderate: ")
  x = np.array([[-1, 0.34, 0,0,1,  0,1,0]],
    dtype=np.float32)
  x = T.tensor(x, dtype=T.float32).to(device) 

  with T.no_grad():
    pred_inc = net(x)
  pred_inc = pred_inc.item()  # scalar
  print("$%0.2f" % (pred_inc * 100_000))  # un-normalized

# -----------------------------------------------------------

  # 6. save model (state_dict approach)
  print("\nSaving trained model state")
  fn = ".\\Models\\people_income_model.pt"
  T.save(net.state_dict(), fn)

  # model = Net()
  # model.load_state_dict(T.load(fn))
  # use model to make prediction(s)

  print("\nEnd People income demo ")

if __name__ == "__main__":
  main()
</pre>
<p>Training data. Tab-delimited. Replace space-space with tab or comma.</p>
<pre>
# people_train.txt
#
# sex (-1 = male, 1 = female), age / 100,
# state (michigan = 100, nebraska = 010, oklahoma = 001),
# income / 100_000,
# politics (conservative = 100, moderate = 010, liberal = 001)
#
1  0.24  1  0  0  0.2950  0  0  1
-1  0.39  0  0  1  0.5120  0  1  0
1  0.63  0  1  0  0.7580  1  0  0
-1  0.36  1  0  0  0.4450  0  1  0
1  0.27  0  1  0  0.2860  0  0  1
1  0.50  0  1  0  0.5650  0  1  0
1  0.50  0  0  1  0.5500  0  1  0
-1  0.19  0  0  1  0.3270  1  0  0
1  0.22  0  1  0  0.2770  0  1  0
-1  0.39  0  0  1  0.4710  0  0  1
1  0.34  1  0  0  0.3940  0  1  0
-1  0.22  1  0  0  0.3350  1  0  0
1  0.35  0  0  1  0.3520  0  0  1
-1  0.33  0  1  0  0.4640  0  1  0
1  0.45  0  1  0  0.5410  0  1  0
1  0.42  0  1  0  0.5070  0  1  0
-1  0.33  0  1  0  0.4680  0  1  0
1  0.25  0  0  1  0.3000  0  1  0
-1  0.31  0  1  0  0.4640  1  0  0
1  0.27  1  0  0  0.3250  0  0  1
1  0.48  1  0  0  0.5400  0  1  0
-1  0.64  0  1  0  0.7130  0  0  1
1  0.61  0  1  0  0.7240  1  0  0
1  0.54  0  0  1  0.6100  1  0  0
1  0.29  1  0  0  0.3630  1  0  0
1  0.50  0  0  1  0.5500  0  1  0
1  0.55  0  0  1  0.6250  1  0  0
1  0.40  1  0  0  0.5240  1  0  0
1  0.22  1  0  0  0.2360  0  0  1
1  0.68  0  1  0  0.7840  1  0  0
-1  0.60  1  0  0  0.7170  0  0  1
-1  0.34  0  0  1  0.4650  0  1  0
-1  0.25  0  0  1  0.3710  1  0  0
-1  0.31  0  1  0  0.4890  0  1  0
1  0.43  0  0  1  0.4800  0  1  0
1  0.58  0  1  0  0.6540  0  0  1
-1  0.55  0  1  0  0.6070  0  0  1
-1  0.43  0  1  0  0.5110  0  1  0
-1  0.43  0  0  1  0.5320  0  1  0
-1  0.21  1  0  0  0.3720  1  0  0
1  0.55  0  0  1  0.6460  1  0  0
1  0.64  0  1  0  0.7480  1  0  0
-1  0.41  1  0  0  0.5880  0  1  0
1  0.64  0  0  1  0.7270  1  0  0
-1  0.56  0  0  1  0.6660  0  0  1
1  0.31  0  0  1  0.3600  0  1  0
-1  0.65  0  0  1  0.7010  0  0  1
1  0.55  0  0  1  0.6430  1  0  0
-1  0.25  1  0  0  0.4030  1  0  0
1  0.46  0  0  1  0.5100  0  1  0
-1  0.36  1  0  0  0.5350  1  0  0
1  0.52  0  1  0  0.5810  0  1  0
1  0.61  0  0  1  0.6790  1  0  0
1  0.57  0  0  1  0.6570  1  0  0
-1  0.46  0  1  0  0.5260  0  1  0
-1  0.62  1  0  0  0.6680  0  0  1
1  0.55  0  0  1  0.6270  1  0  0
-1  0.22  0  0  1  0.2770  0  1  0
-1  0.50  1  0  0  0.6290  1  0  0
-1  0.32  0  1  0  0.4180  0  1  0
-1  0.21  0  0  1  0.3560  1  0  0
1  0.44  0  1  0  0.5200  0  1  0
1  0.46  0  1  0  0.5170  0  1  0
1  0.62  0  1  0  0.6970  1  0  0
1  0.57  0  1  0  0.6640  1  0  0
-1  0.67  0  0  1  0.7580  0  0  1
1  0.29  1  0  0  0.3430  0  0  1
1  0.53  1  0  0  0.6010  1  0  0
-1  0.44  1  0  0  0.5480  0  1  0
1  0.46  0  1  0  0.5230  0  1  0
-1  0.20  0  1  0  0.3010  0  1  0
-1  0.38  1  0  0  0.5350  0  1  0
1  0.50  0  1  0  0.5860  0  1  0
1  0.33  0  1  0  0.4250  0  1  0
-1  0.33  0  1  0  0.3930  0  1  0
1  0.26  0  1  0  0.4040  1  0  0
1  0.58  1  0  0  0.7070  1  0  0
1  0.43  0  0  1  0.4800  0  1  0
-1  0.46  1  0  0  0.6440  1  0  0
1  0.60  1  0  0  0.7170  1  0  0
-1  0.42  1  0  0  0.4890  0  1  0
-1  0.56  0  0  1  0.5640  0  0  1
-1  0.62  0  1  0  0.6630  0  0  1
-1  0.50  1  0  0  0.6480  0  1  0
1  0.47  0  0  1  0.5200  0  1  0
-1  0.67  0  1  0  0.8040  0  0  1
-1  0.40  0  0  1  0.5040  0  1  0
1  0.42  0  1  0  0.4840  0  1  0
1  0.64  1  0  0  0.7200  1  0  0
-1  0.47  1  0  0  0.5870  0  0  1
1  0.45  0  1  0  0.5280  0  1  0
-1  0.25  0  0  1  0.4090  1  0  0
1  0.38  1  0  0  0.4840  1  0  0
1  0.55  0  0  1  0.6000  0  1  0
-1  0.44  1  0  0  0.6060  0  1  0
1  0.33  1  0  0  0.4100  0  1  0
1  0.34  0  0  1  0.3900  0  1  0
1  0.27  0  1  0  0.3370  0  0  1
1  0.32  0  1  0  0.4070  0  1  0
1  0.42  0  0  1  0.4700  0  1  0
-1  0.24  0  0  1  0.4030  1  0  0
1  0.42  0  1  0  0.5030  0  1  0
1  0.25  0  0  1  0.2800  0  0  1
1  0.51  0  1  0  0.5800  0  1  0
-1  0.55  0  1  0  0.6350  0  0  1
1  0.44  1  0  0  0.4780  0  0  1
-1  0.18  1  0  0  0.3980  1  0  0
-1  0.67  0  1  0  0.7160  0  0  1
1  0.45  0  0  1  0.5000  0  1  0
1  0.48  1  0  0  0.5580  0  1  0
-1  0.25  0  1  0  0.3900  0  1  0
-1  0.67  1  0  0  0.7830  0  1  0
1  0.37  0  0  1  0.4200  0  1  0
-1  0.32  1  0  0  0.4270  0  1  0
1  0.48  1  0  0  0.5700  0  1  0
-1  0.66  0  0  1  0.7500  0  0  1
1  0.61  1  0  0  0.7000  1  0  0
-1  0.58  0  0  1  0.6890  0  1  0
1  0.19  1  0  0  0.2400  0  0  1
1  0.38  0  0  1  0.4300  0  1  0
-1  0.27  1  0  0  0.3640  0  1  0
1  0.42  1  0  0  0.4800  0  1  0
1  0.60  1  0  0  0.7130  1  0  0
-1  0.27  0  0  1  0.3480  1  0  0
1  0.29  0  1  0  0.3710  1  0  0
-1  0.43  1  0  0  0.5670  0  1  0
1  0.48  1  0  0  0.5670  0  1  0
1  0.27  0  0  1  0.2940  0  0  1
-1  0.44  1  0  0  0.5520  1  0  0
1  0.23  0  1  0  0.2630  0  0  1
-1  0.36  0  1  0  0.5300  0  0  1
1  0.64  0  0  1  0.7250  1  0  0
1  0.29  0  0  1  0.3000  0  0  1
-1  0.33  1  0  0  0.4930  0  1  0
-1  0.66  0  1  0  0.7500  0  0  1
-1  0.21  0  0  1  0.3430  1  0  0
1  0.27  1  0  0  0.3270  0  0  1
1  0.29  1  0  0  0.3180  0  0  1
-1  0.31  1  0  0  0.4860  0  1  0
1  0.36  0  0  1  0.4100  0  1  0
1  0.49  0  1  0  0.5570  0  1  0
-1  0.28  1  0  0  0.3840  1  0  0
-1  0.43  0  0  1  0.5660  0  1  0
-1  0.46  0  1  0  0.5880  0  1  0
1  0.57  1  0  0  0.6980  1  0  0
-1  0.52  0  0  1  0.5940  0  1  0
-1  0.31  0  0  1  0.4350  0  1  0
-1  0.55  1  0  0  0.6200  0  0  1
1  0.50  1  0  0  0.5640  0  1  0
1  0.48  0  1  0  0.5590  0  1  0
-1  0.22  0  0  1  0.3450  1  0  0
1  0.59  0  0  1  0.6670  1  0  0
1  0.34  1  0  0  0.4280  0  0  1
-1  0.64  1  0  0  0.7720  0  0  1
1  0.29  0  0  1  0.3350  0  0  1
-1  0.34  0  1  0  0.4320  0  1  0
-1  0.61  1  0  0  0.7500  0  0  1
1  0.64  0  0  1  0.7110  1  0  0
-1  0.29  1  0  0  0.4130  1  0  0
1  0.63  0  1  0  0.7060  1  0  0
-1  0.29  0  1  0  0.4000  1  0  0
-1  0.51  1  0  0  0.6270  0  1  0
-1  0.24  0  0  1  0.3770  1  0  0
1  0.48  0  1  0  0.5750  0  1  0
1  0.18  1  0  0  0.2740  1  0  0
1  0.18  1  0  0  0.2030  0  0  1
1  0.33  0  1  0  0.3820  0  0  1
-1  0.20  0  0  1  0.3480  1  0  0
1  0.29  0  0  1  0.3300  0  0  1
-1  0.44  0  0  1  0.6300  1  0  0
-1  0.65  0  0  1  0.8180  1  0  0
-1  0.56  1  0  0  0.6370  0  0  1
-1  0.52  0  0  1  0.5840  0  1  0
-1  0.29  0  1  0  0.4860  1  0  0
-1  0.47  0  1  0  0.5890  0  1  0
1  0.68  1  0  0  0.7260  0  0  1
1  0.31  0  0  1  0.3600  0  1  0
1  0.61  0  1  0  0.6250  0  0  1
1  0.19  0  1  0  0.2150  0  0  1
1  0.38  0  0  1  0.4300  0  1  0
-1  0.26  1  0  0  0.4230  1  0  0
1  0.61  0  1  0  0.6740  1  0  0
1  0.40  1  0  0  0.4650  0  1  0
-1  0.49  1  0  0  0.6520  0  1  0
1  0.56  1  0  0  0.6750  1  0  0
-1  0.48  0  1  0  0.6600  0  1  0
1  0.52  1  0  0  0.5630  0  0  1
-1  0.18  1  0  0  0.2980  1  0  0
-1  0.56  0  0  1  0.5930  0  0  1
-1  0.52  0  1  0  0.6440  0  1  0
-1  0.18  0  1  0  0.2860  0  1  0
-1  0.58  1  0  0  0.6620  0  0  1
-1  0.39  0  1  0  0.5510  0  1  0
-1  0.46  1  0  0  0.6290  0  1  0
-1  0.40  0  1  0  0.4620  0  1  0
-1  0.60  1  0  0  0.7270  0  0  1
1  0.36  0  1  0  0.4070  0  0  1
1  0.44  1  0  0  0.5230  0  1  0
1  0.28  1  0  0  0.3130  0  0  1
1  0.54  0  0  1  0.6260  1  0  0
</pre>
<p>Test data. Tab-delimited. Replace space-space with tab or comma.</p>
<pre>
# people_test.txt
#
-1  0.51  1  0  0  0.6120  0  1  0
-1  0.32  0  1  0  0.4610  0  1  0
1  0.55  1  0  0  0.6270  1  0  0
1  0.25  0  0  1  0.2620  0  0  1
1  0.33  0  0  1  0.3730  0  0  1
-1  0.29  0  1  0  0.4620  1  0  0
1  0.65  1  0  0  0.7270  1  0  0
-1  0.43  0  1  0  0.5140  0  1  0
-1  0.54  0  1  0  0.6480  0  0  1
1  0.61  0  1  0  0.7270  1  0  0
1  0.52  0  1  0  0.6360  1  0  0
1  0.3  0  1  0  0.3350  0  0  1
1  0.29  1  0  0  0.3140  0  0  1
-1  0.47  0  0  1  0.5940  0  1  0
1  0.39  0  1  0  0.4780  0  1  0
1  0.47  0  0  1  0.5200  0  1  0
-1  0.49  1  0  0  0.5860  0  1  0
-1  0.63  0  0  1  0.6740  0  0  1
-1  0.3  1  0  0  0.3920  1  0  0
-1  0.61  0  0  1  0.6960  0  0  1
-1  0.47  0  0  1  0.5870  0  1  0
1  0.3  0  0  1  0.3450  0  0  1
-1  0.51  0  0  1  0.5800  0  1  0
-1  0.24  1  0  0  0.3880  0  1  0
-1  0.49  1  0  0  0.6450  0  1  0
1  0.66  0  0  1  0.7450  1  0  0
-1  0.65  1  0  0  0.7690  1  0  0
-1  0.46  0  1  0  0.5800  1  0  0
-1  0.45  0  0  1  0.5180  0  1  0
-1  0.47  1  0  0  0.6360  1  0  0
-1  0.29  1  0  0  0.4480  1  0  0
-1  0.57  0  0  1  0.6930  0  0  1
-1  0.2  1  0  0  0.2870  0  0  1
-1  0.35  1  0  0  0.4340  0  1  0
-1  0.61  0  0  1  0.6700  0  0  1
-1  0.31  0  0  1  0.3730  0  1  0
1  0.18  1  0  0  0.2080  0  0  1
1  0.26  0  0  1  0.2920  0  0  1
-1  0.28  1  0  0  0.3640  0  0  1
-1  0.59  0  0  1  0.6940  0  0  1
</pre>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-29662" class="share-facebook sd-button share-icon" href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-x"><a rel="nofollow noopener noreferrer" data-shared="sharing-x-29662" class="share-x sd-button share-icon" href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/?share=x" target="_blank" title="Click to share on X" ><span>X</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-16384225-29662-660f9a9a285c0' data-src='//widgets.wp.com/likes/index.html?ver=20240405#blog_id=16384225&amp;post_id=29662&amp;origin=jamesmccaffrey.wordpress.com&amp;obj_id=16384225-29662-660f9a9a285c0' data-name='like-post-frame-16384225-29662-660f9a9a285c0' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>											</div><!-- .entry-content -->

		
						<div class="entry-utility">
							This entry was posted in <a href="https://jamesmccaffrey.wordpress.com/category/pytorch/" rel="category tag">PyTorch</a>. Bookmark the <a href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" title="Permalink to Regression Using a PyTorch Neural Network with a Transformer&nbsp;Component" rel="bookmark">permalink</a>.													</div><!-- .entry-utility -->
					</div><!-- #post-29662 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://jamesmccaffrey.wordpress.com/2023/11/30/an-example-of-an-ensemble-system-with-a-neural-network-and-a-k-nearest-neighbors-model-from-scratch-using-csharp/" rel="prev"><span class="meta-nav">&larr;</span> An Example of an Ensemble System With a Neural Network and a k-Nearest Neighbors Model From Scratch Using&nbsp;C#</a></div>
					<div class="nav-next"><a href="https://jamesmccaffrey.wordpress.com/2023/12/04/a-quick-look-at-the-lm-studio-tool-for-exploring-large-language-models/" rel="next">A Quick Look At The LM Studio Tool For Exploring Large Language&nbsp;Models <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">



	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://jamesmccaffrey.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><div id="comment-form__verbum" class="transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='29662' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="1e5edc5b0f" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

	
			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
						<ul class="xoxo">

<li id="linkcat-6851815" class="widget-container widget_links"><h3 class="widget-title">Books (By Me!)</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.amazon.com/NET-Test-Automation-Recipes-Problem-Solution/dp/1590596633" title="A problem-solution approach to writing lightweight software test automation with C#."><img src="https://jamesmccaffrey.files.wordpress.com/2010/10/dotnettestautomationrecipessmallx.jpg"  alt=".NET Test Automation Recipes"  title="A problem-solution approach to writing lightweight software test automation with C#." /> .NET Test Automation Recipes</a></li>
<li><a href="http://www.amazon.com/Software-Testing-Fundamental-Principles-Essential/dp/1439229074" title="A brief and to-the-point overview of 42 topics identified by hiring managers as key knowledge."><img src="https://jamesmccaffrey.files.wordpress.com/2010/10/softwaretestingfundamentalprinciplessmallx.jpg"  alt="Software Testing"  title="A brief and to-the-point overview of 42 topics identified by hiring managers as key knowledge." /> Software Testing</a></li>
<li><a href="https://www.syncfusion.com/resources/techportal/details/ebooks/SciPy_Programming_Succinctly" title="You can get a free PDF version of my book about SciPy programming"><img src="https://jamesmccaffrey.files.wordpress.com/2016/09/scipyprogrammingsuccinctlycoversmall.jpg"  alt="SciPy Programming Succinctly"  title="You can get a free PDF version of my book about SciPy programming" /> SciPy Programming Succinctly</a></li>
<li><a href="https://www.syncfusion.com/ebooks/cntk_succinctly" title="You can get a free PDF version of my book about Keras from https://www.syncfusion.com/ebooks/cntk_succinctly"><img src="https://jamesmccaffrey.files.wordpress.com/2018/10/keras_succinctly_small.jpg"  alt="Keras Succinctly"  title="You can get a free PDF version of my book about Keras from https://www.syncfusion.com/ebooks/cntk_succinctly" /> Keras Succinctly</a></li>
<li><a href="https://www.syncfusion.com/resources/techportal/details/ebooks/R-Programming_Succinctly" title="https://www.syncfusion.com/resources/techportal/details/ebooks/R-Programming_Succinctly"><img src="https://jamesmccaffrey.files.wordpress.com/2017/06/r-programming_succinctly_cover_small.jpg"  alt="R Programming"  title="https://www.syncfusion.com/resources/techportal/details/ebooks/R-Programming_Succinctly" /> R Programming</a></li>
<li><a href="https://jamesmccaffrey.wordpress.com">_____________________________________________</a></li>

	</ul>
</li>
<li id="linkcat-43656899" class="widget-container widget_links"><h3 class="widget-title">Events (I Speak At!)</h3>
	<ul class='xoxo blogroll'>
<li><a href="https://vslive.com" title="I am tentatively scheduled to speak at the 2024 Visual Studio Live Conference, March 3-8, in Las Vegas."><img src="https://jamesmccaffrey.files.wordpress.com/2023/09/2024_vs_live_banner.jpg"  alt="2024 Visual Studio Live Conference"  title="I am tentatively scheduled to speak at the 2024 Visual Studio Live Conference, March 3-8, in Las Vegas." /> 2024 Visual Studio Live Conference</a></li>
<li><a href="https://www.predictiveanalyticsworld.com/" title="I am tentatively scheduled to give a talk at the 2024 Predictive Analytics World event, June 2024 (exact dates TBD), in Las Vegas"><img src="https://jamesmccaffrey.files.wordpress.com/2023/09/2024_mlw_banner.jpg"  alt="2024 Predictive Analytics World"  title="I am tentatively scheduled to give a talk at the 2024 Predictive Analytics World event, June 2024 (exact dates TBD), in Las Vegas" /> 2024 Predictive Analytics World</a></li>
<li><a href="https://devintersection.com" title="I am tentatively scheduled to speak at the 2024 DevIntersection Conference, December 2024 (exact dates TBD)"><img src="https://jamesmccaffrey.files.wordpress.com/2023/09/2024_devintersection_banner.jpg"  alt="2024 DevIntersection Conference"  title="I am tentatively scheduled to speak at the 2024 DevIntersection Conference, December 2024 (exact dates TBD)" /> 2024 DevIntersection Conference</a></li>
<li><a href="https://www.microsoft.com" title="I gave a talk at the Microsoft internal-only Machine Learning, AI, and Data Science Conference, December 4-7, 2023, in Redmond, WA"><img src="https://jamesmccaffrey.files.wordpress.com/2020/01/mlads_spring_2020.jpg"  alt="2023 Fall MLADS Conference"  title="I gave a talk at the Microsoft internal-only Machine Learning, AI, and Data Science Conference, December 4-7, 2023, in Redmond, WA" /> 2023 Fall MLADS Conference</a></li>
<li><a href="https://us.money2020.com/" title="I was tentatively scheduled to speak at the 2022 Money 20/20 Conference, Oct. 23-26 in Las Vegas but I canceled because of covid"><img src="https://jamesmccaffrey.files.wordpress.com/2022/02/money2020_2022.jpg"  alt="2022 Money 20/20 Conference"  title="I was tentatively scheduled to speak at the 2022 Money 20/20 Conference, Oct. 23-26 in Las Vegas but I canceled because of covid" /> 2022 Money 20/20 Conference</a></li>
<li><a href="https://www.defcon.org/" title="I was tentatively scheduled to give a short, informal talk at the 2022 DEF CON Conference, August 11-14, in Las Vegas, but I canceled because of covid."><img src="https://jamesmccaffrey.files.wordpress.com/2022/02/defcon_2022.jpg"  alt="2022 DEFCON Conference"  title="I was tentatively scheduled to give a short, informal talk at the 2022 DEF CON Conference, August 11-14, in Las Vegas, but I canceled because of covid." /> 2022 DEFCON Conference</a></li>
<li><a href="https://www.globalgamingexpo.com/en-us.html" title="I was tentatively scheduled to give a short talk about machine learning for sports predictions at the 2022 G2E Conference, Oct. 10-13, in Las Vegas but I canceled because of covid."><img src="https://jamesmccaffrey.files.wordpress.com/2022/02/g2e_2022.jpg"  alt="2022 G2E Conference"  title="I was tentatively scheduled to give a short talk about machine learning for sports predictions at the 2022 G2E Conference, Oct. 10-13, in Las Vegas but I canceled because of covid." /> 2022 G2E Conference</a></li>
<li><a href="https://www.unlv.edu/igi" title="I was tentatively scheduled to give a short talk at the 2023 International Conference on Gaming and Risk Taking, May 23-25, Las Vegas but had to cancel."><img src="https://jamesmccaffrey.files.wordpress.com/2022/04/2023_icgrt-1.jpg"  alt="2023 ICGRT Conference"  title="I was tentatively scheduled to give a short talk at the 2023 International Conference on Gaming and Risk Taking, May 23-25, Las Vegas but had to cancel." /> 2023 ICGRT Conference</a></li>
<li><a href="https://www.casinoesportconf.com/" title="I have spoken at the CEC event in the past. The 2023 edition ran Feb. 27 – Mar. 1, 2023, in Las Vegas. Maybe I’ll speak at the 2024 event."><img src="https://jamesmccaffrey.files.wordpress.com/2022/05/cec_2023.jpg"  alt="2024 CEC eSports Conference"  title="I have spoken at the CEC event in the past. The 2023 edition ran Feb. 27 – Mar. 1, 2023, in Las Vegas. Maybe I’ll speak at the 2024 event." /> 2024 CEC eSports Conference</a></li>
<li><a href="https://www.iscwest.com/" title="I missed the 2022 and 2023 ISC West Conferences; I hope to attend the 2024 edition."><img src="https://jamesmccaffrey.files.wordpress.com/2022/02/isc_west_2022.jpg"  alt="2024 ISC West Conference"  title="I missed the 2022 and 2023 ISC West Conferences; I hope to attend the 2024 edition." /> 2024 ISC West Conference</a></li>

	</ul>
</li>

		<li id="recent-posts-2" class="widget-container widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="https://jamesmccaffrey.wordpress.com/2024/04/04/microsoft-data-scientist-weighs-in-on-ai-hallucinations-on-the-pure-ai-web-site/">&#8220;Microsoft Data Scientist Weighs In on AI Hallucinations&#8221; on the Pure AI Web&nbsp;Site</a>
									</li>
											<li>
					<a href="https://jamesmccaffrey.wordpress.com/2024/04/03/data-clustering-from-scratch-using-a-self-organizing-map-som-with-javascript/">Data Clustering from Scratch Using a Self-Organizing Map (SOM) with&nbsp;JavaScript</a>
									</li>
											<li>
					<a href="https://jamesmccaffrey.wordpress.com/2024/04/02/a-lightweight-five-card-poker-library-using-python/">A Lightweight Five-Card Poker Library Using&nbsp;Python</a>
									</li>
					</ul>

		</li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
		<select id="archives-dropdown-2" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='https://jamesmccaffrey.wordpress.com/2024/04/'> April 2024 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2024/03/'> March 2024 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2024/02/'> February 2024 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2024/01/'> January 2024 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/12/'> December 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/11/'> November 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/10/'> October 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/09/'> September 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/08/'> August 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/07/'> July 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/06/'> June 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/05/'> May 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/04/'> April 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/03/'> March 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/02/'> February 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2023/01/'> January 2023 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/12/'> December 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/11/'> November 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/10/'> October 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/09/'> September 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/08/'> August 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/07/'> July 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/06/'> June 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/05/'> May 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/04/'> April 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/03/'> March 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/02/'> February 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2022/01/'> January 2022 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/12/'> December 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/11/'> November 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/10/'> October 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/09/'> September 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/08/'> August 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/07/'> July 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/06/'> June 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/05/'> May 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/04/'> April 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/03/'> March 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/02/'> February 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2021/01/'> January 2021 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/12/'> December 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/11/'> November 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/10/'> October 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/09/'> September 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/08/'> August 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/07/'> July 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/06/'> June 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/05/'> May 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/04/'> April 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/03/'> March 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/02/'> February 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2020/01/'> January 2020 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/12/'> December 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/11/'> November 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/10/'> October 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/09/'> September 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/08/'> August 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/07/'> July 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/06/'> June 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/05/'> May 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/04/'> April 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/03/'> March 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/02/'> February 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2019/01/'> January 2019 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/12/'> December 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/11/'> November 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/10/'> October 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/09/'> September 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/08/'> August 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/07/'> July 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/06/'> June 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/05/'> May 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/04/'> April 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/03/'> March 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/02/'> February 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2018/01/'> January 2018 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/12/'> December 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/11/'> November 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/10/'> October 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/09/'> September 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/08/'> August 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/07/'> July 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/06/'> June 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/05/'> May 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/04/'> April 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/03/'> March 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/02/'> February 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2017/01/'> January 2017 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/12/'> December 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/11/'> November 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/10/'> October 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/09/'> September 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/08/'> August 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/07/'> July 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/06/'> June 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/05/'> May 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/04/'> April 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/03/'> March 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/02/'> February 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2016/01/'> January 2016 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/12/'> December 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/11/'> November 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/10/'> October 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/09/'> September 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/08/'> August 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/07/'> July 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/06/'> June 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/05/'> May 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/04/'> April 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/03/'> March 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/02/'> February 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2015/01/'> January 2015 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/12/'> December 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/11/'> November 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/10/'> October 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/09/'> September 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/08/'> August 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/07/'> July 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/06/'> June 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/05/'> May 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/04/'> April 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/03/'> March 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/02/'> February 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2014/01/'> January 2014 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/12/'> December 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/11/'> November 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/10/'> October 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/09/'> September 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/08/'> August 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/07/'> July 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/06/'> June 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/05/'> May 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/04/'> April 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/03/'> March 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/02/'> February 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2013/01/'> January 2013 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/12/'> December 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/11/'> November 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/10/'> October 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/09/'> September 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/08/'> August 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/07/'> July 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/06/'> June 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/05/'> May 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/04/'> April 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/03/'> March 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/02/'> February 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2012/01/'> January 2012 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/12/'> December 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/11/'> November 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/10/'> October 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/09/'> September 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/08/'> August 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/07/'> July 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/06/'> June 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/05/'> May 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/04/'> April 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/03/'> March 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/02/'> February 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2011/01/'> January 2011 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/12/'> December 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/11/'> November 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/10/'> October 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/09/'> September 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/08/'> August 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/07/'> July 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/06/'> June 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/05/'> May 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/04/'> April 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/03/'> March 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/02/'> February 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2010/01/'> January 2010 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/12/'> December 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/11/'> November 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/10/'> October 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/09/'> September 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/08/'> August 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/07/'> July 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/06/'> June 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/05/'> May 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/04/'> April 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/03/'> March 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/02/'> February 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2009/01/'> January 2009 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/12/'> December 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/11/'> November 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/10/'> October 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/09/'> September 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/08/'> August 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/07/'> July 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/06/'> June 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/05/'> May 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/04/'> April 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/03/'> March 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/02/'> February 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2008/01/'> January 2008 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/12/'> December 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/11/'> November 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/10/'> October 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/09/'> September 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/08/'> August 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/07/'> July 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/06/'> June 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/05/'> May 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/04/'> April 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/03/'> March 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/02/'> February 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2007/01/'> January 2007 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/12/'> December 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/11/'> November 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/10/'> October 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/09/'> September 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/08/'> August 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/07/'> July 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/06/'> June 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/05/'> May 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/04/'> April 2006 </option>
	<option value='https://jamesmccaffrey.wordpress.com/2006/03/'> March 2006 </option>

		</select>

			<script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "archives-dropdown-2" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();

/* ]]> */
</script>
</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-116889440"><a href="https://jamesmccaffrey.wordpress.com/category/cntk/">CNTK</a>
</li>
	<li class="cat-item cat-item-9204"><a href="https://jamesmccaffrey.wordpress.com/category/conferences/">Conferences</a>
</li>
	<li class="cat-item cat-item-457"><a href="https://jamesmccaffrey.wordpress.com/category/javascript/">JavaScript</a>
</li>
	<li class="cat-item cat-item-1772715"><a href="https://jamesmccaffrey.wordpress.com/category/keras/">Keras</a>
</li>
	<li class="cat-item cat-item-40978"><a href="https://jamesmccaffrey.wordpress.com/category/machine-learning/">Machine Learning</a>
</li>
	<li class="cat-item cat-item-875"><a href="https://jamesmccaffrey.wordpress.com/category/miscellaneous/">Miscellaneous</a>
</li>
	<li class="cat-item cat-item-224303"><a href="https://jamesmccaffrey.wordpress.com/category/conferences/paw/">PAW</a>
</li>
	<li class="cat-item cat-item-5868"><a href="https://jamesmccaffrey.wordpress.com/category/poker/">Poker</a>
</li>
	<li class="cat-item cat-item-37985"><a href="https://jamesmccaffrey.wordpress.com/category/prediction-markets/">Prediction Markets</a>
</li>
	<li class="cat-item cat-item-556315009"><a href="https://jamesmccaffrey.wordpress.com/category/pytorch/">PyTorch</a>
</li>
	<li class="cat-item cat-item-8026612"><a href="https://jamesmccaffrey.wordpress.com/category/r-language/">R Language</a>
</li>
	<li class="cat-item cat-item-94055240"><a href="https://jamesmccaffrey.wordpress.com/category/scikit/">Scikit</a>
</li>
	<li class="cat-item cat-item-151164"><a href="https://jamesmccaffrey.wordpress.com/category/software-test-automation/">Software Test Automation</a>
</li>
	<li class="cat-item cat-item-9026"><a href="https://jamesmccaffrey.wordpress.com/category/top-ten/">Top Ten</a>
</li>
	<li class="cat-item cat-item-97421"><a href="https://jamesmccaffrey.wordpress.com/category/pytorch/transformers/">Transformers</a>
</li>
	<li class="cat-item cat-item-2586142"><a href="https://jamesmccaffrey.wordpress.com/category/zoltar/">Zoltar</a>
</li>
			</ul>

			</li>			</ul>
		</div><!-- #primary .widget-area -->


		<div id="secondary" class="widget-area" role="complementary">
			<ul class="xoxo">
				<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://jamesmccaffrey.wordpress.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li>			</ul>
		</div><!-- #secondary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="https://jamesmccaffrey.wordpress.com/" title="James D. McCaffrey" rel="home">
					James D. McCaffrey				</a>
							</div><!-- #site-info -->

			<div id="site-generator">
								<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

<!--  -->
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=2024144d47d929f88574eb4a47e5b1778b683b87e7f6078bb6a33f34c1178752e83406" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile': 'Edit your profile',
							'View profile': 'View profile',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Sorry, we are unable to load this Gravatar profile. Please check your internet connection.': 'Sorry, we are unable to load this Gravatar profile. Please check your internet connection.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	</div>
	<div id="actionbar" style="display: none;"
			class="actnbr-pub-twentyten actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/#respond">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://jamesmccaffrey.wordpress.com">
				<img alt='' src='https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=50&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' srcset='https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=50&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=75&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=100&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=150&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=200&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x' class='avatar avatar-50' height='50' width='50' />				James D. McCaffrey			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 328 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="16384225" />
										<input type="hidden" name="source" value="https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="8f0ead3701" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F&#038;signup_flow=account">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://jamesmccaffrey.wordpress.com">
				<img alt='' src='https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=50&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' srcset='https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=50&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=75&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=100&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=150&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/cd89cfbb9010ec5655890fdf9f5e8f604aef064313aefe978d98d23ffe4a10db?s=200&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x' class='avatar avatar-50' height='50' width='50' />				James D. McCaffrey			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://jamesmccaffrey.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"/></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F&#038;signup_flow=account">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/p16KhH-7Iq">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://jamesmccaffrey.wordpress.com/2023/12/01/regression-using-a-pytorch-neural-network-with-a-transformer-component/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/16384225/posts/29662">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<div id="jp-carousel-comment-form-commenting-as">
												<p id="jp-carousel-commenting-as">
													You must be <a href="#" class="jp-carousel-comment-login">logged in</a> to post a comment.												</p>
											</div>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/jamesmccaffrey.wordpress.com\/2023\/12\/01\/regression-using-a-pytorch-neural-network-with-a-transformer-component\/":29662};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/_static/??-eJyljEsKgDAMBS9kDUUquhDPom0Qaz/BNHh9KdgTuBl4w2PgIWVzKpgKRFEU5DgTg8dCm72+DTHnCicBGex2Z2EMwM9JeKtdkgvYW+YOftTaqYkaXOOix8noQU+z8S9MR0BZ&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/jamesmccaffrey.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"56e879ff2f","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"1","require_name_email":"1","login_url":"https:\/\/jamesmccaffrey.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fjamesmccaffrey.wordpress.com%2F2023%2F12%2F01%2Fregression-using-a-pytorch-neural-network-with-a-transformer-component%2F","blog_id":"16384225","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=16384225&v=wpcom&tz=-7&user_id=0&subd=jamesmccaffrey","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from James D. McCaffrey","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":16384225,"postId":29662,"mustLogIn":true,"requireNameEmail":true,"commentRegistration":true,"connectURL":"https:\/\/jamesmccaffrey.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/jamesmccaffrey.wordpress.com\/wp-login.php?action=logout&_wpnonce=8c4083201d","homeURL":"https:\/\/jamesmccaffrey.wordpress.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"f6cb5710e4","verbumBundleUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1705430309}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJydj9FOQjEMQH/IUQkh4oPxU0zZGthl7ea6Qu7fs5hdhWg08alre9qdwqU4n6WRNGBzJdkhikKKJ1J4NzI6ooREdTXpA3Q4ik8WenNS8Jm5D7pKJc0rjrJAP2ycqBX0J9dLl9IHRwM4Z4EzScgV0FpmbC36bzho9bC3mEKH697Yjc8VUJV6CLMgR+9SxvCl+4vJrcBbP2us91izKaVPbin8ceCCDd/79P86esRKAUOYP55RDsPjlV/WT4+77eZ5vdlNVxGzq90='></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-x' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-x' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomx', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src='https://widgets.wp.com/likes/master.html?ver=20240405#ver=20240405&amp;origin=https://jamesmccaffrey.wordpress.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'16384225','blog_tz':'-7','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'16384225','v':'wpcom','tz':'-7','user_id':'0','post':'29662','subd':'jamesmccaffrey'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1mNzc2NTVTamdsd0xoLz9RQkM2K298TXY9bERQMXc2MjhEaVZfb2wwakRoSj0mUkp1THptM1NdbkV1WjZIcU9mVWQmPUIvMlN6Jk8wW3NYVEJ3dWZOWExuWD9VNTEucGVsV35zPU5yfnJXOFF1MnBkZG9JTS1YZnZNclo5OHljVk94a0lOQ353WHlyLTgwWmRFQl9CcE5lUEcvL1s1Nl1GazZ+WHlIN2xOYldGQVFbeV1bYkNDcDVwcFJTVU5GYTczR0ZUMmNuYXdbZ1lKcU9+OWl5SF0sckRhTFFTd3wzNjhfUE4zOXVrODY5UythZVIuL0pPcVdBJjZYM0JKZmFEWmNyOXJyQUNmRnxdUkVlMFV+N2w/RDJdOTVPTTgtK2xLZ2JlYU9wS3krd09BTQ=='}]);
_stq.push([ 'clickTrackerInit', '16384225', '29662' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'verbum': 'https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1712093674i&minify=false&ver=640445783f1629d8ee43'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('verbum');
			promises['verbum'] = promises['verbum'] || loadWPScript('verbum');
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		return loadExtra(handle, 'before')
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>
</body>
</html>
